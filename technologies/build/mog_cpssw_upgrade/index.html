<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="AI Bots Create, Deploy & Execute Automation(s) using Cognitive Conversation(s) and help Enterprise SRE & SME' scale new business requirements while keeping the overall resource cost low"><meta name=author content="Sridhar P Naidu"><link href=https://extreme-spartan.github.io/cognitive-automation/technologies/build/mog_cpssw_upgrade/ rel=canonical><link rel=icon href=../../../assets/favicon.png><meta name=generator content="mkdocs-1.4.3, mkdocs-material-8.3.4"><title>Getting started - ExtremeSpartan Cognitive Industries Private Limited - Deploy Automation as a Service</title><link rel=stylesheet href=../../../assets/stylesheets/main.4a0965b7.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.cbb835fc.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link rel=stylesheet href=../../../overrides/assets/stylesheets/main.82a244a8.min.css></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=green data-md-color-accent=indigo> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#21-introduction class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> </div> </aside> </div> <header class="md-header md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title="ExtremeSpartan Cognitive Industries Private Limited - Deploy Automation as a Service" class="md-header__button md-logo" aria-label="ExtremeSpartan Cognitive Industries Private Limited - Deploy Automation as a Service" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"> <!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--> <path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/> </svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> ExtremeSpartan Cognitive Industries Private Limited - Deploy Automation as a Service </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Getting started </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=green data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=violet data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../../introduction/ class=md-tabs__link> Executive Summary </a> </li> <li class=md-tabs__item> <a href=../../../service-offerings/ class=md-tabs__link> Cognitive AI Automation as a Service Offerings </a> </li> <li class=md-tabs__item> <a href=../../../sre/overview/ class=md-tabs__link> SRE </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="ExtremeSpartan Cognitive Industries Private Limited - Deploy Automation as a Service" class="md-nav__button md-logo" aria-label="ExtremeSpartan Cognitive Industries Private Limited - Deploy Automation as a Service" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"> <!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--> <path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/> </svg> </a> ExtremeSpartan Cognitive Industries Private Limited - Deploy Automation as a Service </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> Executive Summary <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Executive Summary" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Executive Summary </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../introduction/ class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../../../industrywise-overview/ class=md-nav__link> Industrywsie Overview </a> </li> <li class=md-nav__item> <a href=../../../ai-applications/ class=md-nav__link> AI Application Abilities </a> </li> <li class=md-nav__item> <a href=../../../business-use-cases/ class=md-nav__link> Business Use Cases </a> </li> <li class=md-nav__item> <a href=../../../benefits-of-ai-implementation/ class=md-nav__link> Benefits of AI Implementation </a> </li> <li class=md-nav__item> <a href=../../../case-studies/ class=md-nav__link> Case Studies </a> </li> <li class=md-nav__item> <a href=../../../implementation-strategy/ class=md-nav__link> Implementation Strategy </a> </li> <li class=md-nav__item> <a href=../../../roi-and-cost-analysis/ class=md-nav__link> ROI and Cost Analysis </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../service-offerings/ class=md-nav__link> Cognitive AI Automation as a Service Offerings </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> SRE <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=SRE data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> SRE </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../sre/overview/ class=md-nav__link> Overview and Status </a> </li> <li class=md-nav__item> <a href=../../../sre/pag/ class=md-nav__link> Processes & Guidelines </a> </li> <li class=md-nav__item> <a href=../../../key-trainings-for-squads.md class=md-nav__link> Key Trainings for Squads </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4 type=checkbox id=__nav_4_4> <label class=md-nav__link for=__nav_4_4> Real vs Cognitive Automated Roles <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Real vs Cognitive Automated Roles" data-md-level=2> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> Real vs Cognitive Automated Roles </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../botalogue/real_pm.md class=md-nav__link> Project Manager </a> </li> <li class=md-nav__item> <a href=../../../botalogue/cognitive_pm.md class=md-nav__link> Cognitive PM </a> </li> <li class=md-nav__item> <a href=../../../botalogue/real_sam.md class=md-nav__link> Service Availability Manager </a> </li> <li class=md-nav__item> <a href=../../../botalogue/cognitive_sam.md class=md-nav__link> Cognitive SAM </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#21-introduction class=md-nav__link> 2.1 Introduction </a> </li> <li class=md-nav__item> <a href=#22-prerequisites class=md-nav__link> 2.2 Prerequisites </a> </li> <li class=md-nav__item> <a href=#23-assumptions-and-acronyms-used-in-the-documentation class=md-nav__link> 2.3 Assumptions and Acronyms used in the documentation </a> </li> <li class=md-nav__item> <a href=#24-steps-involved-in-the-upgrade-of-cpssw-2320-to-cpssw233 class=md-nav__link> 2.4 Steps involved in the Upgrade of CPSSW 2320 to CPSSW233. </a> </li> <li class=md-nav__item> <a href=#25-setup-a-new-cps-sw-2333 class=md-nav__link> 2.5 Setup a new CPS SW 2.3.3.3 </a> </li> <li class=md-nav__item> <a href=#26-create-the-new-vm-using-vsphere-power-cli-on-rtem class=md-nav__link> 2.6 Create the new VM using vSphere Power CLI on RTEM </a> </li> <li class=md-nav__item> <a href=#27-post-deployment-steps class=md-nav__link> 2.7 Post Deployment steps </a> </li> <li class=md-nav__item> <a href=#28-procedure class=md-nav__link> 2.8 Procedure </a> </li> <li class=md-nav__item> <a href=#29-create-a-backup-location-on-2320 class=md-nav__link> 2.9 Create a backup location on 2.3.2.0 </a> </li> <li class=md-nav__item> <a href=#210-take-a-full-backup-of-cps-sw-2320 class=md-nav__link> 2.10 Take a full backup of CPS SW 2320 </a> </li> <li class=md-nav__item> <a href=#211-disable-phase-3 class=md-nav__link> 2.11 Disable Phase 3 </a> </li> <li class=md-nav__item> <a href=#212-offline-db2-backup class=md-nav__link> 2.12 Offline DB2 backup </a> </li> <li class=md-nav__item> <a href=#213-modify-the-phase2-to-disable-db2 class=md-nav__link> 2.13 Modify the Phase2 to disable db2 </a> </li> <li class=md-nav__item> <a href=#214-restoring-backed-up-data-into-cps-sw-2333-environment class=md-nav__link> 2.14 Restoring backed up data into CPS SW 2.3.3.3 environment </a> </li> <li class=md-nav__item> <a href=#215-post-configuration-steps class=md-nav__link> 2.15 Post Configuration steps </a> </li> <li class=md-nav__item> <a href=#216-validation-and-checks class=md-nav__link> 2.16 Validation and checks </a> </li> <li class=md-nav__item> <a href=#217-known-issues class=md-nav__link> 2.17 Known issues </a> </li> <li class=md-nav__item> <a href=#218-update-script-history class=md-nav__link> 2.18 Update script history </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Getting started</h1> <h4 id=21-introduction>2.1 Introduction<a class=headerlink href=#21-introduction title="Permanent link">&para;</a></h4> <p>This document is providing instructions to <strong>upgrade CPS SW</strong> from <strong>version 2.3.2.0 to 2.3.3.3.</strong></p> <p>Upgrading CPS SW from v2.3.2.0 to 2.3.3.3 is not possible through the regular maintenance process because these 2 versions do not run on the same OS: CPS SW 2.3.2.0 only runs on RHEL 6.x while CPS SW only runs on RHEL 7. Therefore, the operation is a lot more complex and time consuming. But CPS SW 2.3.3.3 is a major step for several reasons.</p> <p>‚Ä¢ It is now running on RHEL 7, which will solve some security and support issues(RHEL6 is very old). ‚Ä¢ It brings support for VM Mobility which is a major feature for the Enterprise Private IaaS that is waited for many years.</p> <h4 id=22-prerequisites>2.2 Prerequisites<a class=headerlink href=#22-prerequisites title="Permanent link">&para;</a></h4> <p>‚Ä¢ Have administrator access to the PureApplication Software and to the BMLS that is hosting it.</p> <p>‚Ä¢ Have access to the Meta Model Manager tool (3M).</p> <h4 id=23-assumptions-and-acronyms-used-in-the-documentation>2.3 Assumptions and Acronyms used in the documentation<a class=headerlink href=#23-assumptions-and-acronyms-used-in-the-documentation title="Permanent link">&para;</a></h4> <p>This document is assuming that the CPS SW environment is healthy.</p> <p>Please get familiar with the Acronyms used in the document</p> <table> <thead> <tr> <th align=left><strong>CPS</strong></th> <th align=left><strong>Cloud Pak system</strong></th> </tr> </thead> <tbody> <tr> <td align=left><strong>CPSSW</strong></td> <td align=left><strong>Cloud Pak system Software (Also known as PAS)</strong></td> </tr> <tr> <td align=left><strong>Legacy CPSSW</strong></td> <td align=left><strong>Cloud Pak system Software on 2320</strong></td> </tr> </tbody> </table> <h4 id=24-steps-involved-in-the-upgrade-of-cpssw-2320-to-cpssw233>2.4 Steps involved in the Upgrade of CPSSW 2320 to CPSSW233.<a class=headerlink href=#24-steps-involved-in-the-upgrade-of-cpssw-2320-to-cpssw233 title="Permanent link">&para;</a></h4> <p>Follow the steps one after another for the upgrade process:</p> <ol> <li>Create a new instance of CPS SW 2.3.3.3 on a new RHEL 7 VM</li> <li>Take a full backup of the existing CPS SW 2.3.2.0</li> <li>Take an offline backup of the Db2 database of CPS SW 2.3.2.0</li> <li>Restore the back up into the new CPS SW 2.3.3.3.</li> <li>Configure the new CPS SW 2.3.3.3</li> <li>Validate the new CPS SW</li> <li>Delete the existing CPSSW 2.3.2.0</li> </ol> <h4 id=25-setup-a-new-cps-sw-2333>2.5 Setup a new CPS SW 2.3.3.3<a class=headerlink href=#25-setup-a-new-cps-sw-2333 title="Permanent link">&para;</a></h4> <p>We are going to deploy the CPSSW 2333 using the OVA image. This new CPSSW 2333 VM will temporarily use a different IP address than the one used by the Legacy CPSSW 2320. Get this temporary IP address and its gateway ready (if any question, ask Eric Lesport).</p> <p>Before you begin, create a datastore of size 2.3 TB and assign it to the same VMCG as Legacy CPSSW2320. Datastore name must be: ‚Ä¢ On internal storage: ‚Äú<cpssw hostname>_VMPAS_0002‚Äù ‚Ä¢ On external storage: ‚Äú<cpssw hostname>_VMPAS_EXT_02‚Äù Note that ‚Äú<cpssw hostname>_VMPAS_0001‚Äù or ‚Äú<cpssw hostname>_VMPAS_EXT_01‚Äù should already exist and be used by the legacy CPSSW.</p> <p><img alt=üí° class=emojione src=https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/png/1f4a1.png title=:bulb:> <strong><em>Leave the ‚Äúassociate system‚Äù field blank on the CPS volumes page</em></strong></p> <p>You need to login to the Jump server which is the closest to the BMLS on which you need to create a PAS, e.g. if you need to create a PAS on a BMLS in Balsberg, you should connect to the Jump Server in Balsberg. If you face some issues doing so, try the other Jump server of the given region, in the other datacenter (Paulstrasse in our example) but do not change for another region. The same rule applies to the RTEM server you‚Äôll work with. It should be the RTEM located in the same datacenter or, in worst case, in the other datacenter of the same region. You can connect to the ‚Äúlocal‚Äù Jump Server directly from CyberArk or by running a new Remote Desktop connection from your usual Jump Server (in any region).</p> <table> <thead> <tr> <th><br>Region</th> <th><br>Location</th> <th><br>Jump Server</th> <th><br>RTEM</th> </tr> </thead> <tbody> <tr> <td><br>SE</td> <td><br>Clichy</td> <td><br>10.227.94.23</td> <td><br>10.227.89.135</td> </tr> <tr> <td><br>SE</td> <td><br>Lognes</td> <td><br>10.227.94.138<br>10.227.94.150</td> <td><br>10.227.89.136</td> </tr> <tr> <td><br>NE</td> <td><br>Koln</td> <td><br>10.241.180.33</td> <td><br>10.241.183.137</td> </tr> <tr> <td><br>NE</td> <td><br>Leverkusen</td> <td><br>10.241.181.33</td> <td><br>10.241.183.138</td> </tr> <tr> <td><br>NA</td> <td><br>Suwanee</td> <td><br>10.168.125.33</td> <td><br>10.68.124.135</td> </tr> <tr> <td><br>NA</td> <td><br>Atlanta</td> <td><br>10.168.126.33</td> <td><br>10.68.124.136</td> </tr> <tr> <td><br>ME</td> <td><br>Paulstrasse</td> <td><br>10.99.2.33</td> <td><br>10.99.5.135</td> </tr> <tr> <td><br>ME</td> <td><br>Balsberg</td> <td><br>10.99.3.33</td> <td><br>10.99.5.136</td> </tr> <tr> <td><br>AS</td> <td><br>Singtel</td> <td><br>10.99.129.33</td> <td><br>10.99.132.135</td> </tr> <tr> <td><br>AS</td> <td><br>Keppel</td> <td><br>10.99.130.33</td> <td><br>10.99.132.136</td> </tr> </tbody> </table> <p>Login using Remote Desktop Connection to the local Jump Server form CyberArk or from your usual Jump Server.</p> <p>Once you logged into the local Jump Server, mount the ‚Äúshare‚Äù directory from RTEM server on the local regional server. You can do this in 2 different ways:</p> <p>‚Ä¢ Option 1: you can open the ‚ÄúRun‚Äù window and open "\LOCALRTEMIP\share‚Äù</p> <p><img alt="Windows Command Prompt" src=../assets/images/Run1.png></p> <p>‚Ä¢ Option 2: You can open a Windows Explorer, click on ‚ÄúMap network drive‚Äù in the ‚ÄúComputer‚Äù menu. Enter "\LOCALRTEMIP\share‚Äù as Folder</p> <p><img alt="Map Network Drive" src=../assets/images/MapNetworkDrive.png></p> <p>The PAS OVA image is under the below directory. \<rtem_ip>\share\receive\secl\all\productinstallpackages\software\pas\install\PAS_InstallPAS_233\PAS233_PRELOADED1.ova</p> <p>Except for SECL : \10.227.89.135\share\send\all\productinstallpackages\software\pas\install\PAS_Install\PAS_233\PAS233_PRELOADED1.ova</p> <h4 id=26-create-the-new-vm-using-vsphere-power-cli-on-rtem>2.6 Create the new VM using vSphere Power CLI on RTEM<a class=headerlink href=#26-create-the-new-vm-using-vsphere-power-cli-on-rtem title="Permanent link">&para;</a></h4> <p>Login to RTEM and run the following commands</p> <p>Refer to the table RTEM_table to get the RTEM IP. For example, login to 10.227.89.135 using your AD ID (e.g. <a href=mailto:myname@cloudfabric.intrsre>&#109;&#121;&#110;&#97;&#109;&#101;&#64;&#99;&#108;&#111;&#117;&#100;&#102;&#97;&#98;&#114;&#105;&#99;&#46;&#105;&#110;&#116;&#114;&#115;&#114;&#101;</a>) and then</p> <p>1.Run ‚Äúpwsh‚Äù</p> <p><img alt=pwsh src=../assets/images/pwsh.png></p> <p>2.Then</p> <p>Set-PowerCLIConfiguration -ProxyPolicy NoProxy -Scope User -InvalidCertificateAction Ignore -DefaultVIServerMode Single</p> <p>It will prompt to confirm</p> <p>Press ‚ÄúY‚Äù</p> <p><img alt="prompt to confirm" src=../assets/images/promptToConfirm.png></p> <p>3.Now connect to the vCenter with the following command.</p> <p>Connect-VIServer -Server 'vcenter.fullfqdn' -Protocol https -User 'username' -Password 'XXXXXXXXXXX' &gt;&gt; Connect the the Vcenter</p> <p>For example:</p> <p>Connect-VIServer -Server 'SELOGRVGN3VMW03.cloudfabric.infratest' -Protocol https -User '<a href=mailto:app_6ce279d5@vsphere.local>&#97;&#112;&#112;&#95;&#54;&#99;&#101;&#50;&#55;&#57;&#100;&#53;&#64;&#118;&#115;&#112;&#104;&#101;&#114;&#101;&#46;&#108;&#111;&#99;&#97;&#108;</a>' -Password 'XXXXXX‚Äô</p> <p><img alt="Connect VIServer" src=../assets/images/ConnectViServer.png></p> <p><strong>Note</strong> : Open Command prompt from the Windows RDP and run nslookup command to get the FQDN of the vCenter.</p> <p>4.Now gather all the information before running the below command.</p> <p>‚Ä¢ ESXI_where_should_be_the_vm: IP address of the compute node where the CPSSW 2333 VM will be created.</p> <p>‚Ä¢ Source: should be the path where the OVA file is present</p> <p>‚Ä¢ Datastore name: you can find this from CPS Cloud -&gt; Volumes. Look for the Datastore name</p> <p>‚Ä¢ Final_vm_name: hostname of the CPSSW. The name of the VM should be same has Legacy CPSSW 2320 with ‚Äò-1‚Äô. </p> <p>For example, if the hostname of the legacy CPSSW2320 is SECLPRVGN3PAS15 create VM as SECLPRVGN3PAS15-1</p> <p><img alt="Legacy PAS VM" src=../assets/images/LegacyPAS.png></p> <p>Get-VMHost 'ESXI_where_should_be_the_vm' | Import-vApp -Source ' /share/.../PAS_233/PAS233_PRELOADED1.ova' -Datastore 'datastore_name'</p> <p>-Name 'final_vm_name' -DiskStorageFormat thin -Force</p> <p>For example: Get-VMHost '10.227.56.8' | Import-vApp -Source '/share/receive/secl/all/productinstallpackages/software/pas/install/PAS_InstallPAS_233/</p> <p>PAS233_PRELOADED1.ova ' -Datastore 'p_147d25a7-137a-4721-b91d-ca3543d0a59c' -Name ' SECLPRVGN3PAS15-1' -DiskStorageFormat thin -Force</p> <p>It would approximately take 2 hours to complete and after completing you will output as shown in the screenshot below.</p> <p><img alt="Completion Output" src=../assets/images/CompletionOutput.png></p> <p>5.Once the VM is created in vCenter make sure you disconnect</p> <p>Disconnect-VIServer -Server 'SELOGRVGN3VMW03.cloudfabric.infratest'</p> <p><img alt="Disconnect VIServer" src="../assets/images/Disconnect VIserver.png"></p> <p>6.Now go to vCenter</p> <p>Edit the VM settings you created, click the ‚ÄúNew device‚Ä¶‚Äù button at the bottom of the Virtual Hardware tab and add a Network card.</p> <p><img alt="VM Edit Setting" src=../assets/images/EditSetting.png></p> <p>On the ‚ÄúNew Network‚Äù card, select the drop list and choose ‚Äúshow more networks‚Äù.</p> <p>Then select the right VLAN: you must choose the VLAN ID on which the PAS will be (usually 2106, see information provided by project</p> <p>management or, by default, table in chapter ¬ß1.1. Click OK.</p> <p>Note that, on the 2 following screenshots, VLAN 2006 is selected instead of VLAN 2106. This is because the screenshot was taken in </p> <p>Infratest, using different VLANs.</p> <p><img alt="Select Network" src=../assets/images/SelectNetwork.png></p> <p>Ensure that the ‚ÄòConnect at Power On‚Äô option is checked, then OK.</p> <p><img alt="Select Network" src=../assets/images/ConnectAtPowerOn.png></p> <p>7.You also need to change some CPU settings on the PAS VM.</p> <p>Expand the ‚ÄúCPU‚Äù section in Virtual Hardware and change the following settings: ‚Ä¢ CPU Reservation: 4000 MHz ‚Ä¢ CPU Limit: Unlimited MHz ‚Ä¢ CPU Shares: Custom 256000</p> <p><img alt="Select Network" src=../assets/images/ChangeCPSsettings.png></p> <p>Click OK to validate.</p> <p>8.Now find the datastore of the CPSSW VM and expand the OS disk to Thick provision</p> <p>Select the CPSSW 2330 VM and select Datastores</p> <p><img alt="Datastore to expand" src=../assets/images/DatastoreToExpand.png></p> <p>Select the datastore and Click Browse files now select the CPSSW2333 VM folder and select the first disk with the HOSTNAME-1.vmdk</p> <p>For example below MEBAPPVGN3PAS05-1.vmdk</p> <p><img alt="Browse Datastore1" src=../assets/images/BrowseFile1.png></p> <p><img alt="Browse Datastore2" src=../assets/images/BrowseFile2.png></p> <p>Now look at the task and once its 100% your VM is good to be powered on.</p> <p><img alt="Browse Datastore3" src=../assets/images/100Percent.png></p> <p>9.Configure the VM‚Äôs network</p> <p>Use VMWare remote console to login the VM. Use the ‚Äúroot‚Äù username &amp; Password.</p> <p>From the VM command line, run the following command to configure the network card:</p> <p>nmcli con add con-name ens192 type ethernet ipv4.method manual ifname ens192 ipv4.address CPSSW_temp_IP ipv4.gateway CPSSW_temp_Gateway</p> <p>For example:</p> <p>nmcli con add con-name ens192 type ethernet ipv4.method manual \</p> <p>ifname ens192 ipv4.address 10.99.6.50/23 ipv4.gateway 10.99.7.254</p> <h4 id=27-post-deployment-steps>2.7 Post Deployment steps<a class=headerlink href=#27-post-deployment-steps title="Permanent link">&para;</a></h4> <p>Before you begin, please ensure all the psm services are online. Run ‚Äúpsm info all‚Äù </p> <p>1) SSH to the CPSSW 2333 and run the below command Yum update</p> <p>2) Configure Cloud Management IP, DNS.</p> <p><strong>Note.</strong> that the GUI has changed with CPS SW 2.3.3.3, compared to v2.3.2.0. Especially, the single menu has moved to the top left (the 3 horizontal lines in the corner) and some sections has moved within the menu. For example, the ‚Äújob queue‚Äù has moved from the ‚ÄúSystem‚Äù menu (in 2.3.2.0 and earlier) to a new ‚ÄúProblem Determination‚Äù menu (in 2.3.3.3).</p> <p><img alt="Menu Problem Determination" src=../assets/images/ProblemDetermination.png></p> <p>Go to ‚ÄúSystem -&gt; System Settings‚Äù. </p> <p><img alt="Menu System Settings" src=../assets/images/SystemSettings.png></p> <p><img alt="Menu System Settings1" src=../assets/images/SystemSettings1.png></p> <p>On the Cloud Management IP section, enter the PAS IP Address; PAS name, set cloudfabric.intrsre as the domain name, netmask and Default</p> <p>Gateway. Leave the default value for the VLANS list.</p> <p>All this information must be the same as on the legacy CPSSW. Do not use the temporary IP address that has been given to this CPSSW</p> <p>2333 VM. It‚Äôs normal to have a temporary inconsistency between CPS SW IP and VM IP. This will be fixed in a next step of the procedure.</p> <p>Be careful, once the values are entered and confirmed you cannot change it. Any change would require recreating the PAS VM.</p> <p><img alt=DNS1 src=../assets/images/DNS1.png></p> <p>Confirm the modification. Notice that you cannot change these values once saved!</p> <p><img alt="Cloud IP Mgmt" src=../assets/images/CloudIPMgmt.png></p> <p>The save request will trigger an internal Job. The information message contains a direct link to the Job Queue where the job completion</p> <p>may be monitored</p> <p><img alt="JOb Queue" src=../assets/images/JobQueue.png></p> <p>Simply wait for the job status to reach ‚ÄòSuccess‚Äô, then go back to the Cloud Management IP section. There, add the management VLAN in the VLANS list</p> <p><img alt=VLAN src=../assets/images/VLAN.png></p> <p>3) On the System Settings page, expand the ‚ÄúDomain Name Service (DNS)‚Äù section.</p> <p><img alt="Domain Name Service" src=../assets/images/DomainNameService.png></p> <p>Enter the DNS servers IP address and hit save (see ‚Äú¬ß1.1 Configuration parameters you need as input‚Äù). Be careful as the DNS servers IP depends on the region.</p> <p><img alt=DNS2 src=../assets/images/DNS2.png></p> <p>In case of OpenPaaS, you also need to add, in 3<sup>rd</sup> and 4<sup>th</sup> positions, the following DNS: ‚Ä¢ 10.99.124.6 ‚Ä¢ 10.99.124.7</p> <p>In the ‚ÄòLookup host name or IP address‚Äô field, put both the PAS name, and IP address to check direct lookup and reverse DNS lookup</p> <p><img alt=DNS3 src=../assets/images/DNS3.png></p> <p>4) Manually configure LDAP from Cloud Pak menu ÔÉ† Security and Access ÔÉ† System Security Replicate the below configuration from CPSSW 2320 to CPSSW 2333. You can also us the 3M tool (Tools -&gt; Script Launcher -&gt; ‚ÄúConfigure PAS Network (IP Groups, Cloud Groups, Environment Profile) as Admin user‚Äù) put it requires to temporarily add an entry in its Environment database with the temp IP address of the CPSSW VM. Make sur to accept the LDAPS certificate and Ensure you are able to authenticate using your LDAP account.</p> <p><img alt=LDAP src=../assets/images/LDAP.png></p> <p>5) Backup LDAP files</p> <p><a href=https://ibm.box.com/s/873ifds2g13ailo2p1gpej8nudoqhuix>https://ibm.box.com/s/873ifds2g13ailo2p1gpej8nudoqhuix</a> to execute this step</p> <p>SSH to CPS SW 2333 and SCP the file upgrade.tar upgrade_scripts_3.2.0.tgz</p> <p>‚Ä¢ Untar the file using tar -xvzf upgrade_scripts_3.2.0.tgz ‚Ä¢ cd upgrade_scripts/ ‚Ä¢ ./upgrade.sh</p> <p>From the below menu please run option 3)</p> <p><img alt="Script Menu Option" src=../assets/images/ScriptMenuOption.png></p> <h4 id=28-procedure>2.8 Procedure<a class=headerlink href=#28-procedure title="Permanent link">&para;</a></h4> <p>Cloud Pak System Software/PAS Version 2.3.2.0 is supported only on RHEL 6.x (6.6) and version Cloud Pak System Software/PAS 2.3.3.3 needs 7.7. In other words, version 2.3.2.0 does not run on RHEL 7.7 and version 2.3.3.3 does not work with RHEL 6.x. Given this OS dependency, a direct software upgrade from 2.3.2.0 to 2.3.3.3 is not possible. So, the upgrade from 2.3.2.0 to 2.3.3.3 is actually a 'migration'.</p> <p>Since the Cloud Pak System Software/PAS installation is always on a VM, the guidance to customers will be to bring up a new VM running the requisite RHEL 7.7 level and then do the migration. This was discussed and agreed to in the workshop. There will be no use case of upgrading the base OS of the VM itself. During the migration from 2.3.2.0 to 2.3.3.3, there will be the existing RHEL 6.x VM running 2.3.2.0 and the new RHEL 7.x VM running 2.3.3.3. After a successful migration, the old RHEL 6.x VM can be shut down or deleted. The full system backup and restore procedure will be used to move Cloud Pak System data from the old to the new VM.</p> <p>Cloud Pak System offers following categories of backups: ‚Ä¢ System backup ‚Ä¢ Component backup ‚Ä¢ Security (users/groups) backup</p> <p>System backup would be a super set and includes rest of them. More details on setting up the backup locations/ schedules can be found here at the KC section: <a href=https://www.ibm.com/support/knowledgecenter/SSL5ES_2.3.3.0/intel/iwd/brc_overview.html>https://www.ibm.com/support/knowledgecenter/SSL5ES_2.3.3.0/intel/iwd/brc_overview.html</a></p> <p>It‚Äôs important that you understand the backup process. Please read the below carefully before you proceed.</p> <p>The backup process consists of the following jobs:</p> <p><strong>Complete System Information Backup 1 of 3 (Referred as Phase 1 in zero.config file)</strong> This job initiates the backup process. This job remains in the Running state until the background process is initialized, then the second of the three jobs is queued to start. <strong>Complete System Information Backup 2 of 3 (Referred as Phase 2 in zero.config file)</strong> This job prepares the data for backup. New tasks are blocked or placed in a pending state while this job runs to ensure a consistent copy of management databases and other artifacts. After all target data is defined, the third job starts. Note: There is a delay between the completion of the second job and the start of the third job. This behaviour is normal. <strong>Complete System Information Backup 3 of 3 (Referred as Phase 3 in zero.config file)</strong> This job compresses, encrypts, and transfers the target data to the specified remote backup system. The system configuration data on the Platform System Manager and selected component data are included in the system backup. Backup images that are stored on an external backup storage server are encrypted to protect sensitive data, allowing only trusted parties to view the backup image. You can decrypt the backup image only by using the private key, and only on the Cloud Pak System Software for x86 hardware. When you configure your settings for email notification, the system sends an email that provides status information about complete or incomplete backup jobs.</p> <h4 id=29-create-a-backup-location-on-2320>2.9 Create a backup location on 2.3.2.0<a class=headerlink href=#29-create-a-backup-location-on-2320 title="Permanent link">&para;</a></h4> <p>Before you begin extract the system health check report of CPSSW 2320.</p> <p>Configure the backup of CPSSW 2320 to CPSSW 233 which you have setup on Chapter 5</p> <p>Navigate to System ÔÉ†Backup and Restore. Click on ‚ÄúSet up‚Äù</p> <p><img alt="Backup Config" src=../assets/images/BackupConfig.png></p> <p>Click on ‚ÄúCreate New‚Äù.</p> <p><strong>‚Ä¢ Name:</strong> ‚ÄúDefault‚Äù Don‚Äôt change anything <strong>‚Ä¢ Hostname:</strong> IP address of the new CPSSW 2333 Environment you have setup in the Chapter 5 <strong>‚Ä¢ Path:</strong> /cps-sw-data/pas_backup <strong>‚Ä¢ Port:</strong> 22 <strong>‚Ä¢ Username:</strong> root <strong>‚Ä¢ Password:</strong> XXXXXXXXXX (This is the default factory password. If you have changed it, please enter the actual root password). <strong>‚Ä¢ Encryption:</strong> Select the checkbox</p> <p>Finally click ‚ÄúSave‚Äù.</p> <p><img alt="Backup Config Save" src=../assets/images/BackupConfigSave.png></p> <p>Select <strong>‚ÄúGenerate New private key and Certificate‚Äù</strong> and type the passphrase twice for encrypting the backup. </p> <p>Set the passphrase as <strong>"XXXXXXXXXXX"</strong></p> <p><img alt="Backup Config1" src=../assets/images/BackupConfig1.png></p> <p>Now that you have created a location for backup. You have to create a backup configuration</p> <p>Go System ÔÉ†Backup and Restore and select ‚ÄúCreate New‚Äù on the Backup Configurations</p> <p><img alt="Backup Config2" src=../assets/images/BackupConfig2.png></p> <p><strong>‚Ä¢ Name:</strong> PAS2320</p> <p><strong>‚Ä¢ Location:</strong> Select the location from the Dropdown (Select the location you have created in the previous setup. You should have only one Location here)</p> <p><strong>‚Ä¢ Type:</strong> System backup</p> <h4 id=210-take-a-full-backup-of-cps-sw-2320>2.10 Take a full backup of CPS SW 2320<a class=headerlink href=#210-take-a-full-backup-of-cps-sw-2320 title="Permanent link">&para;</a></h4> <p>Navigate to System ÔÉ†Backup and Restore </p> <p>Click on the ‚ÄúBackup Now‚Äù button.</p> <p><img alt="FUll Backup" src=../assets/images/FullBackup.png></p> <p>Full backup takes approximately 2 to 4 hours. After the completion of backup proceed to next step.</p> <h4 id=211-disable-phase-3>2.11 Disable Phase 3<a class=headerlink href=#211-disable-phase-3 title="Permanent link">&para;</a></h4> <p>Please download the scripts from <a href=https://ibm.box.com/s/873ifds2g13ailo2p1gpej8nudoqhuix>https://ibm.box.com/s/873ifds2g13ailo2p1gpej8nudoqhuix</a> to execute this step.</p> <p>SSH to legacy CPS SW 2320 and SCP the file upgrade.tar upgrade_scripts_3.2.0.tgz</p> <p>‚Ä¢ Untar the file using tar -xvzf upgrade_scripts_3.2.0.tgz ‚Ä¢ cd upgrade_scripts/ ‚Ä¢ ./upgrade.sh</p> <p>You will be displayed with the Menu and list of options and Select 1) to disable phase3</p> <p>[root@selotsvgn3pas03 upgrade_scripts]# ./upgrade.sh</p> <p><img alt="Scrip Menu Option1" src=../assets/images/ScriptMenuOption1.png></p> <p>Once this is done, rerun the backup following the instructions from 6.2 except that this time it will not be a full backup but a modified backup.</p> <h4 id=212-offline-db2-backup>2.12 Offline DB2 backup<a class=headerlink href=#212-offline-db2-backup title="Permanent link">&para;</a></h4> <p>Steps to take offline backups: Run the below commands one after another</p> <p>1) mkdir -p /pureapp-sw-data/mkm/offline_backup/databases </p> <p>2) chmod 777 -R /pureapp-sw-data/mkm/offline_backup/databases </p> <p>3) su - db2inst </p> <p>4) db2 quiesce instance db2inst restricted access immediate force connections </p> <p>5) db2 deactivate db RAINMAKE </p> <p>6) db2 backup db RAINMAKE to /pureapp-sw-data/mkm/offline_backup/databases</p> <p>7) db2 activate db RAINMAKE </p> <p>8) db2 deactivate db STORHOUS </p> <p>9) db2 backup db STORHOUS to /pureapp-sw-data/mkm/offline_backup/databases</p> <p>10) db2 activate db STORHOUS </p> <p>11) db2 deactivate db IPASDB </p> <p>12) db2 backup db IPASDB to /pureapp-sw-data/mkm/offline_backup/databases</p> <p>13) db2 activate db IPASDB </p> <p>14) db2 unquiesce instance db2inst</p> <p>Now cd /pureapp-sw-data/mkm/offline_backup/databases</p> <p>Run this for loop ‚Äúfor i in <code>pwd</code>;do db2ckbkp -h $i;done‚Äù</p> <p>Validate all three DB backups by using the above for loop and ensure you see Image Verification Complete ‚Äì successful at the end of each line</p> <p><img alt="Media Header Reach" src=../assets/images/MediaHeaderReach.png></p> <p><img alt="Media Header Reach1" src=../assets/images/MediaHeaderReach1.png></p> <p>Perform this for all the three backup files and note that Backup Mode now seen as Offline. </p> <p><strong>Note:</strong> Since DBs were deactivated for taking offline backup you may find the services in offline state. Wait for all the services to come online before proceeding with next steps. </p> <p>Traverse to the /pureapp-sw-data/mkm/offline_backup/databases folder and compress each backup file separately as follows: </p> <p>1) cd /pureapp-sw-data/mkm/offline_backup/databases</p> <p>2) gzip IPASDB.0.db2inst.DBPART000.20201201081109.001 </p> <p>3) gzip RAINMAKE.0.db2inst.DBPART000.20201201081056.001 </p> <p>4) gzip STORHOUS.0.db2inst.DBPART000.20201201081031.001 </p> <p>Copy the database configuration files from timestamp folder created by step 6.2 (Take a full backup of CPS SW 2320), for example /data/</p> <p>hdd-files/backup/external/1607704844141/databases/ to /pureapp-sw-data/mkm/offline_backup/databases</p> <p><strong>Note: Every time when you run the backup you will see a new folder created under the directory /data/hdd-files/backup/external/.</strong> </p> <p>cd /pureapp-sw-data/mkm/offline_backup/databases</p> <p>From the backup folder created on 6.3 (Disable phase 3), copy the configuration file. For example </p> <p>cp /data/hdd-files/backup/external/1607704844141/databases/*.cfg.gz . </p> <p>-bash-4.1# ls -ltr *.cfg.gz </p> <p>-rw-r--r-- 1 root root 3368 Dec 11 16:52 db_STORHOUS.cfg.gz </p> <p>-rw-r--r-- 1 root root 3362 Dec 11 16:52 db_RAINMAKE.cfg.gz </p> <p>-rw-r--r-- 1 root root 3367 Dec 11 16:52 db_IPASDB.cfg.gz</p> <h4 id=213-modify-the-phase2-to-disable-db2>2.13 Modify the Phase2 to disable db2<a class=headerlink href=#213-modify-the-phase2-to-disable-db2 title="Permanent link">&para;</a></h4> <p>Using the same scripts as used in 6.3 run the script with option 2 ./upgrade.sh</p> <p><img alt="Modify Phase2" src=../assets/images/ModifyPhase2.png></p> <p>Check the status of Service 7 using the ‚Äúpsm info all‚Äù command on the CPS SW 2320 VM. Wait for the Service7 to be online. </p> <p>When we will run the System backup this time, everything should get transferred to the configured backup server. Before we trigger this </p> <p>action, we need to embed the manually taken offline DB backup files into the timestamp folder (for example /data/hdd-files/backup/</p> <p>external/1607704844141).</p> <p><strong>Note:The 3 jobs are triggered back-to-back and first 2 jobs approximately take 2-3 minutes; we have only this 2-3 minutes time window</strong> <strong>(by the time 3<sup>rd</sup> job is triggered) to copy the offline db backup files into the newly created timestamp folder.</strong> </p> <p>Do the following steps: </p> <p>a. Have a PuTTY session opened to PAS 2320 environment and traverse to /data/hdd-files/backup/external/.</p> <p>b. Trigger a System backup once more on the Cloud Pak System user interface and switch to PuTTY session. </p> <p>c. Issue ‚Äúls -ltr‚Äù immediately on the PuTTY session and note down the newly created timestamp folder under /data/hdd-files/backup/ external/. </p> <p>d. Run the following command: </p> <p>cp -R /pureapp-sw-data/mkm/offline_backup/databases <newly_created_timestamp_folder></p> <p>Wait for the phase 3 job to be completed and login to backup server and confirm that the backup file along with DB offline backup files </p> <p>now exist on the location configured. </p> <h4 id=214-restoring-backed-up-data-into-cps-sw-2333-environment>2.14 Restoring backed up data into CPS SW 2.3.3.3 environment<a class=headerlink href=#214-restoring-backed-up-data-into-cps-sw-2333-environment title="Permanent link">&para;</a></h4> <p>‚Ä¢ Log in to CPSSW 2333 user interface and traverse to ‚ÄúSystem -&gt; Backup and Restore‚Äù page. </p> <p>‚Ä¢ Setup a backup location pointing to the same location where we had taken backup in Chapter 6.1</p> <p>‚Ä¢ Select the use the same key option on enabling the encryption and test connectivity of location it should succeed. Chapter 6.1</p> <p><strong>Note:</strong> Two folders might be present under backup location, one for 2320 and one for 2333 VM. In that scenario you will have to copy all the folders from 2320 to 2333 and rename couple of them as mentioned below. If "use the same key" option is greyed out, then download the cert and key files from <backuplocation>/backupSecurity and upload them using option "upload own key files".</p> <p>Log in to the backup server and traverse to the <location_home_folder>. For example, /cps-sw-data/pas_backup</p> <p><img alt="Restoring backedup data" src=../assets/images/restore.png></p> <p>Switch back to the Cloud Pak System user interface and the System -&gt; Backup and Restore page. Refresh the restore section and now it should show the restore location with size of the backup artifact matching with backup taken from CPSSW 2320 environment. </p> <p><img alt="Restoring backedup data1" src=../assets/images/restore1.png></p> <p>Select the restore location and click on Restore data button and select System restore; </p> <p><img alt="Select Restore Location" src=../assets/images/SelectRestoreLocation.png></p> <p>It prompts for a decryption password; enter the password 'XXXXXXXXXXXX'</p> <p>Monitor the restore job. Restoration workflow recycles all the services once restoration is complete. </p> <p>Do not be surprised if you are not able to access the Cloud Pak System user interface on CPSSW 2333 environment for some time. </p> <p>Review all the artifacts deployed on the CPSSW 2320 environment to see if they are still visible on the new 2333 PAS environment.</p> <h4 id=215-post-configuration-steps>2.15 Post Configuration steps<a class=headerlink href=#215-post-configuration-steps title="Permanent link">&para;</a></h4> <p>Assumptions: We assume that you have validated the CPS2333 environment with CPS 2320 Environment and Shutdown or Power off the Legacy CPS2320 Environment. </p> <p>IWD and other sub-systems would be caching the old 2320 PAS PSM management IP in their repositories. Now we would need to transfer the old PAS management IP to this new CPSSW 2333. </p> <p>Perform the following steps: </p> <ol> <li> <p>Shut down the old CPSSW 2320(Legacy) instance from vCenter</p> </li> <li> <p>Open a PuTTY session to new 2333 PAS VM and traverse to /etc/sysconfig/network-scripts/ </p> </li> </ol> <p>cd /etc/sysconfig/network-scripts/ </p> <ol> <li>Edit the ifcfg-ens192 file replace the IPADDR with old CPSSW 2320 IP address: </li> </ol> <p><img alt=ifcfg-ens192 src=../assets/images/ifcfg-ens192.png></p> <ol> <li>Create a ifcfg-ens192:0 file add the following lines; IPADDR here is what you had configured on CPSW 2333 (copy the NETMASK from ifcfg-ens192 file): </li> </ol> <p><img alt=ifcfg-ens192-0 src=../assets/images/ifcfg-ens192-0.png></p> <ol> <li> <p>Save and exit both ifcfg-ens192 and ifcfg-ens192:0 </p> </li> <li> <p>Now SCP the same script package from <a href=https://ibm.box.com/s/fv08fjlalulmecrmlrr58k5kiq680knh>https://ibm.box.com/s/fv08fjlalulmecrmlrr58k5kiq680knh</a> <a href=https://ibm.box.com/s/873ifds2g13ailo2p1gpej8nudoqhuix>https://ibm.box.com/s/873ifds2g13ailo2p1gpej8nudoqhuix</a> to execute this step.</p> </li> </ol> <p>SSH to CPS SW 2330 and SCP the file upgrade_scripts_3.2.0.tgz. Untar and execute as follows:</p> <p><img alt="Upgrade Script Menu" src=../assets/images/UpgradeScriptMenu.png></p> <ol> <li> <p>Now run the option 4) change_backupconfig_2330</p> </li> <li> <p>Now run option 5) sethostname</p> </li> </ol> <p>This will prompt you to enter the CPS2320 (Legacy) Hostname</p> <p><strong>Please enter the hostname of the CPS2320:</strong></p> <p>Note: Please are the list of patches to run after Migration CCPS2320 to CPS2333</p> <ol> <li> <p>Now run option 6) restore_security</p> </li> <li> <p>Reboot is needed </p> </li> <li> <p>Now run option 7) disable_vdcs</p> </li> <li> <p>Now run option 8) white_list</p> </li> <li> <p>Now run option 9) vm_moblity</p> </li> <li> <p>Now run Option 10) diskaddon Disk add on is depreceted (Not Present) </p> </li> <li> <p>Now run Option 10) cpsuipatch</p> </li> <li> <p>Now run Option 11)db2patch</p> </li> <li> <p>Now run Option 12)vm_mobility_RHEL_fix</p> </li> <li> <p>Now run Option 13)vm_mobility_windows_fix</p> </li> <li> <p>Now run Option 14)quit</p> </li> <li> <p>Issue df -h to check the file system utilization statistics. If you find /cps-sw-runtime/ full, check the troubleshooting section and apply the resolution provided before proceeding with CPSSW VM reboot.</p> </li> <li> <p>Now navigate to CloudPak menu -&gt; Security and Access -&gt; Usergroups</p> </li> </ol> <p>Now select BMLS-PureApp-sreDevUsers and select the permission as shown in the oval circle</p> <p><img alt=BMLS-PureApp-sreDevUsers src=../assets/images/BMLS-PureApp-sreDevUsers.png></p> <ol> <li> <p>Reboot the CPSSW VM using shutdown -r now</p> </li> <li> <p>Open an SSH session to PSM and run the following tool to fix or refresh the roles or permissions: </p> </li> </ol> <p>zero ipas.genesis maintenance_upgrade 2.3.3.3 2.3.3.3</p> <ol> <li>Do a data validation using system health check report extracted from Legacy CPSW2320: compare the list of Virtual Appliances, </li> </ol> <p>Virtual System Instances, Virtual Machines, Virtual System Patterns‚Ä¶</p> <h4 id=216-validation-and-checks>2.16 Validation and checks<a class=headerlink href=#216-validation-and-checks title="Permanent link">&para;</a></h4> <p>Deploy a test pattern.</p> <h4 id=217-known-issues>2.17 Known issues<a class=headerlink href=#217-known-issues title="Permanent link">&para;</a></h4> <p><strong>Issue 1</strong>:** /cps-sw-runtime/ File System becomes full. On some PAS system it was observed that the /cps-sw-runtime/ File System was 100%; Due to which the IWD and Service77 could not get started and few configurations supposed to be done when the IWD (Service60) comes up first time got skipped due to space issues. </p> <p><strong>Resolution:</strong> This issue was caused due to a failed image importing workflow leaving behind residual files under /cps-sw-runtime/data/storage/images/ folder; If you find any big vmdk files - clean them up before restarting the PAS after step 4 (Post restore configurations). -bash-4.2# rm -rf /cps-sw-runtime/data/storage/images/<uuid folder> </p> <p><strong>Issue 2:</strong> It is observed that first backup triggered remains in 'Running' state even after all 3 jobs (phase) are completed On some PAS system it was observed that the state of backup schedule remains in 'Running' state even after all the three jobs are completed, blocking the next step. Wait for at least 10 minutes if the status does not change to 'Disabled' and then proceed with the following resolution. </p> <p>***Resolution:**</p> <ol> <li> <p>Make sure all the three jobs are seen completed on the System -&gt; Job queue. We can also check the job log files under /var/log/purescale/ipas.async/backup.</p> </li> <li> <p>Delete and recreate the System Backup Configurations with same location selected.</p> </li> <li> <p>Proceed with the next step. </p> </li> </ol> <p><strong>Issue 3 (Deprecated, Resolved by configuring LDAP on CPS 2333): Unable to login as LDAP user after the restore completes</strong></p> <p><strong>Resolution:</strong> 1. Get the credentials of admin account from CyberArk.</p> <ol> <li> <p>Remove all the entries from the System security (Users and user groups page)</p> </li> <li> <p>Ensure you set the CPSSW admin credentials to passw0rd</p> </li> <li> <p>Reconfigure the LDAP using 3M tool. </p> </li> </ol> <h4 id=218-update-script-history>2.18 Update script history<a class=headerlink href=#218-update-script-history title="Permanent link">&para;</a></h4> <p>When using the update script under /root/upgrade_scripts, a global logs directory is automatically created.</p> <p>Each time a menu option is selected for execution, a record is added in the global log file /root/upgrade_scripts/logs/upgrade.log</p> <p>Sample record:</p> <p>2021-07-27T08:28:19 (/root/upgrade_scripts/upgrade.sh:165) executing step vm_mobility_RHEL_fix</p> <p>2021-07-27T08:28:28 (/root/upgrade_scripts/upgrade.sh:173) quitting upgrade script</p> <p>===================</p> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <b>SPN</b> <div class="md-footer-meta md-typeset"> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["content.code.annotate", "content.tooltips", "navigation.indexes", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.85cb4492.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../../assets/javascripts/bundle.431f3d41.min.js></script> <script src=../../../overrides/assets/javascripts/bundle.1ff6d521.min.js></script> </script> <script>
      window.watsonAssistantChatOptions = {
        integrationID: "2c965e33-9bb7-479b-8fe5-992ec47ab105", // The ID of this integration.
        region: "us-east", // The region your integration is hosted in.
        serviceInstanceID: "6b183879-c8c9-4af3-bede-b0a83705f20b", // The ID of your service instance.
        onLoad: function(instance) { instance.render(); }
      };
      setTimeout(function(){
        const t=document.createElement('script');
        t.src="https://web-chat.global.assistant.watson.appdomain.cloud/versions/" + (window.watsonAssistantChatOptions.clientVersion || 'latest') + "/WatsonAssistantChatEntry.js";
        document.head.appendChild(t);
      });
    </script> </body> </html>